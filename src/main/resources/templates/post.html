<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ -->
    <title th:text="${post.title}">–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å—Ç–∞</title>

    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ - –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* –°—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
        h1 {
            text-align: center;
        }

        /* –°—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü - –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –∏–∑ –æ–±—â–∏—Ö —Å—Ç–∏–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f4f4f4;
        }

        /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π */
        .actions {
            text-align: center;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Ñ–æ—Ä–º */
        .form-container {
            margin-top: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–µ—Ç–æ–∫ —Ñ–æ—Ä–º */
        label {
            display: block;
            margin-top: 10px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
        input[type="text"], input[type="number"], input[type="checkbox"] {
            width: 100%;
            padding: 5px;
            margin-top: 5px;
        }

        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ */
        button {
            padding: 10px 20px;
            margin-top: 10px;
            cursor: pointer;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
        .btn-add {
            margin-bottom: 20px;
        }



        /* –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
        .post-no-image-content {
            width: 100%;
            max-width: 150px;
            height: 100px;
            background-color: #f8f9fa;
            border: 2px dashed #dee2e6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 14px;
            text-align: center;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        /* –°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Å–ø–∏—Å–∫—É –ø–æ—Å—Ç–æ–≤ */
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #007bff;
            text-decoration: none;
            font-size: 16px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Å—Ç–∞ */
        .post-container {
            border: 1px solid #ccc;
            padding: 20px;
            margin-bottom: 30px;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞ - —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–∞ */
        .post-title {
            font-size: 2em;
            margin-bottom: 20px;
            color: #333;
        }

        /* –ü–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ */
        .post-image-full {
            max-width: 100%;
            height: auto;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ */
        .post-content {
            margin-bottom: 20px;
            line-height: 1.6;
            white-space: pre-line;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ–≥–æ–≤ –ø–æ—Å—Ç–∞ */
        .post-tags {
            margin-bottom: 20px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π —Å –ø–æ—Å—Ç–æ–º */
        .post-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞ - –≤ —Å—Ç–∏–ª–µ –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .btn-edit {
            background-color: #f4f4f4;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-decoration: none;
            padding: 10px 20px;
            margin-top: 10px;
            cursor: pointer;
        }

        .btn-edit:hover {
            background-color: #e6e6e6;
        }

        /* –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞ */
        .btn-delete {
            background-color: #f4f4f4;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .btn-delete:hover {
            background-color: #e6e6e6;
        }

        /* –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ */
        .btn-like {
            background-color: #f4f4f4;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .btn-like:hover {
            background-color: #e6e6e6;
        }

        /* –°—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤ */
        .likes-display {
            margin-bottom: 10px;
            font-size: 16px;
        }

        /* === –°–¢–ò–õ–ò –î–õ–Ø –°–ï–ö–¶–ò–ò –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ï–í === */

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ */
        .comments-section {
            border-top: 2px solid #ccc;
            padding-top: 20px;
        }

        /* –®–∞–ø–∫–∞ —Å–µ–∫—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
        .comments-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .comments-header h3 {
            margin: 0;
        }

        /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è - —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        .add-comment-form {
            margin-bottom: 20px;
            display: none;
            border: 1px solid #ccc;
            padding: 15px;
            background-color: #f8f9fa;
        }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .comment-textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            resize: vertical;
            box-sizing: border-box;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ä–º—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .comment-form-actions {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */
        .btn-save {
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
        }

        .btn-save:hover {
            background-color: #218838;
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã */
        .btn-cancel {
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 3px;
        }

        .btn-cancel:hover {
            background-color: #5a6268;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .comment {
            border: 1px solid #ccc;
            margin: 10px 0;
            padding: 15px;
            background-color: #f8f9fa;
        }

        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .comment-content {
            margin-bottom: 10px;
            line-height: 1.5;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º */
        .comment-actions {
            display: flex;
            gap: 10px;
        }

        /* –ú–∞–ª–µ–Ω—å–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ */
        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
            margin: 0;
        }

        /* –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è - –≤ —Å—Ç–∏–ª–µ –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .btn-edit-comment,
        .btn-delete-comment {
            background-color: #f4f4f4;
            color: #333;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .btn-edit-comment:hover,
        .btn-delete-comment:hover {
            background-color: #e6e6e6;
        }

        /* –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
        .edit-textarea {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Å–ø–∏—Å–∫—É –ø–æ—Å—Ç–æ–≤ -->
    <a href="/posts" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ –ª–µ–Ω—Ç–µ –ø–æ—Å—Ç–æ–≤</a>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å—Ç–∞ -->
    <div class="post-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞ –∏–∑ –º–æ–¥–µ–ª–∏ -->
        <h1 class="post-title" th:text="${post.title}">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞</h1>

        <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ –∏–ª–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä -->
        <div class="post-image-container">
            <img class="post-image-full"
                 th:if="${post.filename != null and !post.filename.isEmpty()}"
                 th:src="@{'/images/' + ${post.filename}}"
                 th:alt="${post.title}">
            <div class="post-no-image-content"
                 th:style="${post.filename != null and !post.filename.isEmpty()} ? 'display: none;' : 'display: flex;'">
                <span>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
            </div>
        </div>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞ - —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ -->
        <div class="post-content" th:text="${post.content}">
            –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞
        </div>

        <!-- –¢–µ–≥–∏ –ø–æ—Å—Ç–∞ - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é -->
        <div class="post-tags" th:if="${not #lists.isEmpty(post.tags)}">
            <strong>–¢–µ–≥–∏: </strong>
            <span th:text="${#strings.arrayJoin(post.tags.![name].toArray(), ', ')}">—Ç–µ–≥1, —Ç–µ–≥2, —Ç–µ–≥3</span>
        </div>

        <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–∞–π–∫–æ–≤ -->
        <div class="likes-display">
            <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤: <span th:text="${post.likes}">0</span></strong>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å –ø–æ—Å—Ç–æ–º -->
        <div class="post-actions">
            <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ -->
            <a th:href="@{'/posts/' + ${post.id} + '/edit'}" class="btn-edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º -->
            <button class="btn-delete" onclick="deletePost()" th:data-post-id="${post.id}">–£–¥–∞–ª–∏—Ç—å</button>
            <!-- –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ -->
            <button class="btn-like" onclick="likePost()" th:data-post-id="${post.id}">üëç –õ–∞–π–∫</button>
        </div>
    </div>

    <!-- –°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
    <div class="comments-section">
        <!-- –®–∞–ø–∫–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Å—á–µ—Ç—á–∏–∫–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
        <div class="comments-header">
            <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (<span th:text="${#lists.size(comments)}">0</span>)</h3>
            <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
            <button onclick="toggleAddCommentForm()">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
        </div>

        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è - —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
        <form class="add-comment-form" id="addCommentForm">
            <!-- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
            <textarea class="comment-textarea" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required></textarea>
            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–æ–π -->
            <div class="comment-form-actions">
                <button type="submit" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="btn-cancel" onclick="toggleAddCommentForm()">–û—Ç–º–µ–Ω–∞</button>
            </div>
            <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ –≥–æ—Ä—è—á–µ–π –∫–ª–∞–≤–∏—à–µ -->
            <small>–ù–∞–∂–º–∏—Ç–µ Ctrl+Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</small>
        </form>

        <!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
        <div class="comments-list">
            <!-- –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º –∏–∑ –º–æ–¥–µ–ª–∏ -->
            <div class="comment" th:each="comment : ${comments}">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —Å data-–∞—Ç—Ä–∏–±—É—Ç–æ–º –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <div class="comment-content" th:data-comment-id="${comment.id}">
                    <p th:text="${comment.content}">–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è</p>
                </div>
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º -->
                <div class="comment-actions">
                    <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è inline -->
                    <button class="btn-small btn-edit-comment"
                            onclick="editComment(this)"
                            th:data-comment-id="${comment.id}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º -->
                    <button class="btn-small btn-delete-comment"
                            onclick="deleteComment(this)"
                            th:data-comment-id="${comment.id}">–£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function toggleAddCommentForm() {
        const form = document.getElementById('addCommentForm');
        form.style.display = form.style.display === 'none' ? 'block' : 'none';
        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Ñ–æ—Ä–º—ã
        if (form.style.display === 'block') {
            form.querySelector('textarea').focus();
        }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    document.getElementById('addCommentForm').addEventListener('submit', function(e) {
        e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã
        const textarea = this.querySelector('textarea');
        const content = textarea.value.trim();

        if (content) {
            addComment(content);
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ—Ä—è—á–µ–π –∫–ª–∞–≤–∏—à–∏ Ctrl+Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    document.querySelector('.add-comment-form textarea').addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'Enter') {
            e.preventDefault();
            document.getElementById('addCommentForm').dispatchEvent(new Event('submit'));
        }
    });

    // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function addComment(content) {
        // –ò–∑–≤–ª–µ–∫–∞–µ–º ID –ø–æ—Å—Ç–∞ –∏–∑ URL
        const postId = window.location.pathname.split('/')[2];

        fetch(`/posts/${postId}/comment`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ content: content })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è inline
    function editComment(button) {
        const commentId = button.dataset.commentId;
        const contentDiv = button.closest('.comment').querySelector('.comment-content');
        const currentText = contentDiv.querySelector('p').textContent;

        // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        contentDiv.innerHTML = `
            <textarea class="comment-textarea edit-textarea">${currentText}</textarea>
            <div class="comment-form-actions">
                <button class="btn-small btn-save" onclick="saveComment(${commentId}, this)">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-small btn-cancel" onclick="cancelEditComment(${commentId}, '${currentText.replace(/'/g, "\\'")}', this)">–û—Ç–º–µ–Ω–∞</button>
            </div>
            <small>–ù–∞–∂–º–∏—Ç–µ Ctrl+Enter –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</small>
        `;

        const textarea = contentDiv.querySelector('textarea');
        textarea.focus();

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ Ctrl+Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        textarea.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                saveComment(commentId, contentDiv.querySelector('.btn-save'));
            }
        });
    }

    // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function saveComment(commentId, button) {
        const contentDiv = button.closest('.comment-content');
        const textarea = contentDiv.querySelector('textarea');
        const newContent = textarea.value.trim();

        if (!newContent) {
            alert('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º');
            return;
        }

        fetch(`/comments/${commentId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ content: newContent })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—ã–π –≤–∏–¥ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —Å –Ω–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º
                contentDiv.innerHTML = `<p>${newContent}</p>`;
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function cancelEditComment(commentId, originalText, button) {
        const contentDiv = button.closest('.comment-content');
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
        contentDiv.innerHTML = `<p>${originalText}</p>`;
    }

    // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function deleteComment(button) {
        const commentId = button.dataset.commentId;

        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')) {
            fetch(`/comments/${commentId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∏–∑ DOM
                    button.closest('.comment').remove();
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                    const commentsCount = document.querySelectorAll('.comment').length;
                    document.querySelector('.comments-header h3 span').textContent = commentsCount;
                } else {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
            });
        }
    }

    // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–∞–π–∫–∞ –ø–æ—Å—Ç—É
    function likePost() {
        const postId = document.querySelector('.btn-like').dataset.postId;

        fetch(`/posts/${postId}/like`, {
            method: 'POST'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                document.querySelector('.likes-display span').textContent = data.likes;
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ª–∞–π–∫–∞');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ª–∞–π–∫–∞');
        });
    }

    // AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞
    function deletePost() {
        const postId = document.querySelector('.btn-delete').dataset.postId;

        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) {
            fetch(`/posts/${postId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
                    window.location.href = '/posts';
                } else {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞');
            });
        }
    }
</script>
</body>
</html>